# 計算機科學概念介紹

## 1. Cache Write Through 和 Write Back

### Write Through
- **描述**：每次寫入快取的數據時，會同時將數據寫入主存。這保證了快取和主存中的數據總是一致的。
- **優點**：數據一致性高，即使快取被刷新，主存中的數據也是最新的。
- **缺點**：寫入速度可能較慢，因為每次寫入都需要更新主存。

### Write Back
- **描述**：數據僅在快取中更新，當快取行被替換或清除時，才將數據寫回主存。這樣可以減少寫入操作對主存的頻繁訪問。
- **優點**：寫入速度較快，因為寫入操作僅涉及快取。
- **缺點**：主存中的數據可能不是最新的，直到快取行被替換時才會更新，可能會造成數據不一致問題。

## 2. MESI 協議

MESI 協議是處理器快取一致性協議的一部分，旨在保持多個處理器的快取之間的一致性。MESI 是四個狀態的縮寫：

- **Modified (M)**：快取行被修改，並且與主存中的數據不一致。這個快取行是唯一的來源。
- **Exclusive (E)**：快取行存在於單個處理器的快取中，並且與主存中的數據一致。這個快取行尚未被修改。
- **Shared (S)**：快取行可能存在於多個處理器的快取中，並且與主存中的數據一致。這個快取行尚未被修改。
- **Invalid (I)**：快取行無效，不包含有效數據。

## 3. 變量類型

### Global Variable
- **描述**：在所有函數之外定義的變量，可以被程序中的任何函數訪問。
- **作用域**：全局作用域，整個程序都可以訪問。
- **生命周期**：整個程序執行過程中。

### Local Variable
- **描述**：在函數或區塊內部定義的變量，只在該函數或區塊內部可見。
- **作用域**：函數或區塊內部。
- **生命周期**：函數或區塊執行時存在。

### Static Variable
- **描述**：在函數內部定義，但其值在多次調用間保持不變，或者在類內部定義但所有對象共享。
- **作用域**：函數或類內部。
- **生命周期**：整個程序執行過程中。

### Volatile Variable
- **描述**：告訴編譯器這個變量可能會在程序執行外部（例如硬件、異步事件）被改變，因此編譯器不應該對其進行優化。
- **作用域**：和變量所在的位置相同，但其使用方式特殊。
- **用途**：通常用於硬件寄存器、信號處理等場景。

## 4. Call by Value 和 Call by Reference

### Call by Value
- **描述**：將實際參數的值傳遞給函數。函數內部對參數的修改不會影響原來的實際參數。
- **優點**：避免了函數內部修改外部變量的風險。
- **缺點**：如果傳遞大型數據結構，會產生額外的複製開銷。

### Call by Reference
- **描述**：將實際參數的地址（或引用）傳遞給函數。函數內部對參數的修改會影響原來的實際參數。
- **優點**：避免了大數據結構的複製開銷，直接操作原數據。
- **缺點**：函數內部修改參數可能會影響到外部變量。

## 5. Stack 和 Heap 的不同

### Stack
- **描述**：由編譯器自動管理，用於存儲局部變量和函數調用信息。遵循 LIFO（後進先出）原則。
- **優點**：分配和釋放速度快。
- **缺點**：大小有限，過多的遞歸或大量局部變量可能導致堆棧溢出。

### Heap
- **描述**：由程序員手動管理，用於存儲動態分配的變量（例如，通過 `malloc` 或 `new` 分配的內存）。
- **優點**：內存大小不受限制，只要系統有足夠內存。
- **缺點**：分配和釋放速度較慢，需要手動管理，容易造成內存泄漏和碎片化問題。

## 6. Race Condition

- **描述**：當兩個或多個線程或進程並發執行，且其中至少一個操作對共享數據進行寫操作，這些操作的執行順序未定，導致程序的結果不一致。
- **解決方法**：通過鎖（mutex）、信號量（semaphore）等同步機制來防止。

## 7. Function Interrupt & ISR

### Function Interrupt
- **描述**：指在程序執行過程中，某個中斷事件（例如硬件中斷）打斷了正在執行的函數，並將控制權轉移到中斷處理函數（ISR）。

### ISR (Interrupt Service Routine)
- **描述**：專門處理中斷事件的函數。當中斷發生時，CPU 會自動轉到 ISR 執行，完成中斷處理後，再返回到之前的執行上下文。
- **特性**：ISR 需要快速執行，並且通常要求簡單和高效，以避免阻塞系統的正常操作。

## 8. RISC 和 CISC 的差別

### RISC (Reduced Instruction Set Computer)
- **描述**：簡化指令集計算機，使用少量的簡單指令，所有指令執行時間相對均等。RISC 旨在提高指令的執行速度和效率。
- **優點**：指令執行速度快，簡單的指令可以更快地解碼和執行。

### CISC (Complex Instruction Set Computer)
- **描述**：複雜指令集計算機，支持大量的複雜指令，這些指令可以執行多個操作。CISC 設計的目的是減少程序的長度和提高編程的靈活性。
- **優點**：指令集功能強大，能夠更好地處理複雜操作。

## 9. TLB (Translation Lookaside Buffer)

- **描述**：TLB 是一種快取，用於提高虛擬地址到物理地址的轉換速度。它存儲了最近使用的虛擬地址和物理地址對應的映射。
- **作用**：當 CPU 訪問一個虛擬地址時，首先在 TLB 中查找，從而避免每次都查找頁表，從而提高內存訪問速度。

## 10. Hash Map

- **描述**：Hash Map 是一種資料結構，通過哈希函數將鍵（key）映射到對應的值（value）。它支持快速的插入、查找和刪除操作。
- **應用場景**：
  - **字典查找**：在程序中存儲和查找單詞及其定義。
  - **數據庫索引**：用於實現快速的數據檢索。
  - **緩存**：例如，網頁緩存系統中，使用哈希映射將 URL 映射到網頁內容，快速響應請求。
## 11. Pipelined Processor problem-Hazard
### 1. 資料危害（Data Hazard）

- **描述**：資料危害發生在指令之間存在依賴關係，當一條指令需要讀取前一條指令尚未寫入的資料時，可能導致錯誤或延遲。
- **類型**：
  - **RAW (Read After Write)**：當一條指令需要讀取一個註冊器的值，而該註冊器的值被前一條指令寫入時，會發生資料危害。
  
- **解決方法**：
  - **資料前推（Data Forwarding）**：通過直接將資料從一個流水線階段傳遞到另一個階段，避免等待資料寫回註冊器。
  - **插入空操作（NOPs）**：在需要資料的指令之間插入無操作指令，直到所需的資料準備好。

---

### 2. 控制危害（Control Hazard）

- **描述**：控制危害發生在處理器無法確定分支指令的執行結果，從而無法確定接下來應該執行哪條指令。
- **類型**：
  - **分支指令**：當處理器需要處理分支指令（如條件跳轉）時，會無法立即確定哪條指令需要執行。

- **解決方法**：
  - **分支預測（Branch Prediction）**：使用分支預測機制提前猜測分支的結果，並加載可能的指令。
  - **延遲分支（Delayed Branching）**：將分支指令的執行推遲，允許後續指令執行，直到確定分支結果。
  - **動態分支預測**：通過硬體動態分析分支歷史，來做出更準確的分支預測。

---

### 3. 結構危害（Structural Hazard）

- **描述**：結構危害發生在處理器的硬體資源不足以同時處理多條指令時，當多條指令需要訪問相同的資源時，會發生結構危害。
- **類型**：
  - **資源衝突**：多條指令需要訪問同一個功能單元或記憶體端口。

- **解決方法**：
  - **資源重複（Resource Duplication）**：增加更多的硬體資源，例如更多的執行單元或記憶體端口，來避免資源競爭。
  - **流水線延遲（Pipeline Stalls）**：當硬體資源不可用時，延遲部分指令的執行，直到資源可用。

---

## 結論

流水線處理器中常見的三種 **Hazard** — **資料危害**、**控制危害** 和 **結構危害** — 可能會影響處理器的性能或導致指令執行錯誤。通過使用技術如資料前推、分支預測和資源重複等，可以有效解決這些問題，確保指令執行的正確性與效率。


